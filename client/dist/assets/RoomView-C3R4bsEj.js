import{d as G,p as L,q as N,n as T,c as a,a as e,t as u,b as r,e as d,F as C,l as w,g as q,x as B,o as l,y as I,_ as z}from"./index-BjcpxiQA.js";import{u as E,a as P}from"./room-V_12ESKf.js";const U={class:"room-view"},j={class:"header"},A={class:"header-actions"},J={class:"map-badge"},K={key:0,class:"error-banner"},O={class:"room-content"},Q={class:"teams"},W={class:"team team-ct"},X={class:"player-name"},Y={key:0,class:"badge"},Z={key:1,class:"badge ready"},$={class:"team team-t"},ee={class:"player-name"},se={key:0,class:"badge"},te={key:1,class:"badge ready"},oe={key:0,class:"bots-section"},ne={class:"bots-toggle"},ae=["checked"],le={key:0,class:"bots-options"},re={class:"bots-row"},ue=["value"],ie={class:"bots-row"},ce=["value"],de={class:"controls"},me=["disabled"],ye=G({__name:"RoomView",setup(_e){const y=q(),s=E(),{connect:x,socket:_}=P(),v=B(()=>{const o=_.value,t=s.currentRoom;return!o||!t?!1:t.hostId===o.id});L(()=>{if(!s.currentRoom){y.push({name:"lobby"});return}x();const o=s.setupListeners();N(o)}),T(()=>s.currentRoom,o=>{o?o.status==="playing"&&y.push({name:"networked-game",params:{roomId:o.id}}):y.push({name:"lobby"})});function H(){s.leaveRoom(),y.push({name:"lobby"})}function S(){var t;const o=(t=s.currentRoom)==null?void 0:t.players.find(c=>{var m;return c.socketId===((m=_.value)==null?void 0:m.id)});s.setReady(!(o!=null&&o.isReady))}const i=B(()=>{var o;return((o=s.currentRoom)==null?void 0:o.bots)??{enabled:!1,difficulty:"medium",count:1}});function V(){if(!v.value||!s.currentRoom)return!1;const o=s.currentRoom.players.every(c=>c.isReady||c.isHost),t=i.value.enabled&&i.value.count>0?1:2;return s.currentRoom.players.length>=t&&o}function M(){s.changeBots({enabled:!i.value.enabled})}function D(o){s.changeBots({count:Math.max(0,Math.min(8,o))})}function F(o){s.changeBots({difficulty:o})}return(o,t)=>{var c,m,h,p,b,f,R,g;return l(),a("div",U,[e("header",j,[e("h1",null,u((c=r(s).currentRoom)==null?void 0:c.name),1),e("div",A,[e("span",J,u((m=r(s).currentRoom)==null?void 0:m.map),1),e("button",{class:"btn-leave",onClick:H},"Выйти")])]),r(s).error?(l(),a("div",K,u(r(s).error),1)):d("",!0),e("main",O,[e("div",Q,[e("div",W,[e("h3",null,"CT ("+u(((h=r(s).currentRoom)==null?void 0:h.teams.ct.length)??0)+")",1),(l(!0),a(C,null,w((p=r(s).currentRoom)==null?void 0:p.teams.ct,n=>(l(),a("div",{key:n.socketId,class:I(["player-row",{host:n.isHost,ready:n.isReady}])},[e("span",X,u(n.username),1),n.isHost?(l(),a("span",Y,"Хост")):n.isReady?(l(),a("span",Z,"Готов")):d("",!0)],2))),128))]),e("div",$,[e("h3",null,"T ("+u(((b=r(s).currentRoom)==null?void 0:b.teams.t.length)??0)+")",1),(l(!0),a(C,null,w((f=r(s).currentRoom)==null?void 0:f.teams.t,n=>(l(),a("div",{key:n.socketId,class:I(["player-row",{host:n.isHost,ready:n.isReady}])},[e("span",ee,u(n.username),1),n.isHost?(l(),a("span",se,"Хост")):n.isReady?(l(),a("span",te,"Готов")):d("",!0)],2))),128))])]),v.value?(l(),a("div",oe,[t[7]||(t[7]=e("h4",null,"Боты",-1)),e("label",ne,[e("input",{type:"checkbox",checked:i.value.enabled,onChange:M},null,40,ae),t[3]||(t[3]=e("span",null,"Включить ботов",-1))]),i.value.enabled?(l(),a("div",le,[e("div",re,[t[4]||(t[4]=e("span",null,"Количество:",-1)),e("input",{type:"number",min:"0",max:"8",value:i.value.count,onInput:t[0]||(t[0]=n=>D(+n.target.value||0))},null,40,ue)]),e("div",ie,[t[6]||(t[6]=e("span",null,"Сложность:",-1)),e("select",{value:i.value.difficulty,onChange:t[1]||(t[1]=n=>F(n.target.value))},[...t[5]||(t[5]=[e("option",{value:"easy"},"Лёгкая",-1),e("option",{value:"medium"},"Средняя",-1),e("option",{value:"hard"},"Сложная",-1)])],40,ce)])])):d("",!0)])):d("",!0),e("div",de,[e("button",{class:"btn-ready",onClick:S},u((g=(R=r(s).currentRoom)==null?void 0:R.players.find(n=>{var k;return n.socketId===((k=r(_))==null?void 0:k.id)}))!=null&&g.isReady?"Отменить готовность":"Готов"),1),v.value?(l(),a("button",{key:0,class:"btn-start",disabled:!V(),onClick:t[2]||(t[2]=(...n)=>r(s).startGame&&r(s).startGame(...n))}," Начать игру ",8,me)):d("",!0)])])])}}}),pe=z(ye,[["__scopeId","data-v-8ed60c51"]]);export{pe as default};
